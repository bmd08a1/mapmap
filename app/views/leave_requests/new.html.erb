<h1>New Requests</h1>

<%= form_tag(submit_leave_requests_path, method: "post") do %>
  <%= hidden_field_tag(:leave_request_id, @leave_request_id) %>
  <p>Employee:
    <%= select_tag(:employee_id, options_from_collection_for_select(@employees, :id, :name)) %>
  </p>
  <p>Category:
    <%= select_tag(:category_id, options_from_collection_for_select(@categories, :id, :name)) %>
  </p>
  <p>Duration:
    <input type='text' name='duration' class='duration' />
  </p>

  <%= submit_tag("Submit", class: "btn btn-primary") %>
  <%= link_to 'Back', leave_requests_path, class: "btn btn-default" %>
<% end %>

<script>
  $(function() {
    $('input.duration').daterangepicker({
      "locale": {
        "format": "DD/MM/YYYY"
      }
    }, function(start, end, label) {
      $.ajax(
        {
          'url': '<%= escape_javascript(change_duration_leave_request_url(id: @leave_request_id)) %>',
          'data': {
            'from': start.format('DD/MM/YYYY'),
            'to': end.format('DD/MM/YYYY'),
            'authenticity_token': '<%= form_authenticity_token %>'
          },
          'method': 'POST',
          'success': function(data) {
            console.log(data)
          }
        }
      )
    });
  });
</script>
